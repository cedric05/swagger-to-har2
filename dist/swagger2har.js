!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.swagger2har={})}(this,function(e){"use strict";var t,r=(function(e){var t={string:"",number:0,integer:0,null:null,boolean:!1,object:{}};function r(e,t,r){return!r.requiredPropertiesOnly||r.requiredPropertiesOnly&&function(e,t){var r=!1;return(t=t||[]).forEach(function(t){t===e&&(r=!0)}),r}(e,t.required)}function i(e){return function(e){return Array.isArray(e)}(e.type)&&(e.type=e.type[0]),e.type}e.exports={instantiate:function(e,a){a=a||{};var s={};return function e(s,n,o){if(s){var p,f,u=i(s);if("object"===u&&s.properties)for(var c in o[n]=o[n]||{},s.properties)s.properties.hasOwnProperty(c)&&r(c,s,a)&&e(s.properties[c],c,o[n]);else if(s.allOf)for(p=0;p<s.allOf.length;p++)e(s.allOf[p],n,o);else if("array"===u){o[n]=[];var m=0;for((s.minItems||s.minItems>0)&&(m=s.minItems),p=0;p<m;p++)e(s.items,p,o[n])}else!function(e){return"[object Array]"===Object.prototype.toString.call(e.enum)}(s)?function(e){var r=e.type;return void 0!==t[r]}(s)&&(o[n]=function(e){var r=e.type;return e.default?e.default:t[r]}(s)):o[n]=(f=s).default?f.default:f.enum.length?f.enum[0]:void 0}}(e,"kek",s),s.kek}}}(t={exports:{}},t.exports),t.exports),i=(r.instantiate,r);const a=require("@stoplight/json-schema-sampler");var s=function(e,t,r,i,a){void 0===a&&(a={});var s={method:r.toUpperCase(),url:i+t,headers:f(e,t,r),queryString:p(e,t,r,a),httpVersion:"HTTP/1.1",cookies:[],headersSize:0,bodySize:0,comment:e.paths[t][r].summary},o=n(e,t,r);return o&&(s.postData=o),s},n=function(e,t,r){if(e.openapi&&e.openapi.startsWith("3")){if(e.paths[t][r].requestBody&&e.paths[t][r].requestBody.content){var s=e.paths[t][r].requestBody.content;for(var n in s)if("application/json"===n){if((m=s[n].schema).$ref){var p=m.$ref.split("/").slice(-1)[0];m=o(e,e.components.schemas[p])}var f=JSON.stringify();try{f=a.sample(m)}catch(e){f=i.instantiate(m)}return{mimeType:"application/json",text:JSON.stringify(f)}}}}else if(void 0!==e.paths[t][r].parameters)for(var u in e.paths[t][r].parameters){var c=e.paths[t][r].parameters[u];if(void 0!==c.in&&"body"===c.in.toLowerCase()&&void 0!==c.schema){var m;if(void 0===c.schema.$ref)m=c.schema;else if(/^http/.test(c.schema.$ref));else{p=c.schema.$ref.split("/").slice(-1)[0];m=o(e,e.definitions[p])}f=JSON.stringify();try{f=a.sample(m)}catch(e){f=i.instantiate(m)}return{mimeType:"application/json",text:JSON.stringify(f)}}}return null},o=function(e,t){if("object"===t.type){if(void 0!==t.properties)for(var r in t.properties){var i=t.properties[r];if("string"==typeof i.$ref&&!/^http/.test(i.$ref)){var a=i.$ref.split("/").slice(-1)[0];e.definitions?t.properties[r]=e.definitions[a]:t.properties[r]=e.components.schemas[a]}o(e,t.properties[r])}}else if("array"===t.type&&void 0!==t.items)for(var s in t.items){if("$ref"===s&&!/^http/.test(t.items[s])){var n=t.items.$ref.split("/").slice(-1)[0];e.definitions?t.items=e.definitions[n]:t.items=e.components.schemas[n]}o(e,t.items)}return t},p=function(e,t,r,i){void 0===i&&(i={});var a=[];if(void 0!==e.paths[t][r].parameters)for(var s in e.paths[t][r].parameters){var n=e.paths[t][r].parameters[s];"string"!=typeof n.$ref||/^http/.test(n.$ref)||(n=u(e,n.$ref)),void 0!==n.in&&"query"===n.in.toLowerCase()&&a.push({name:n.name,value:void 0===i[n.name]?void 0===n.default?e.openapi?"<SOME_"+(n.schema&&n.schema.type?n.schema.type:"").toUpperCase()+"_VALUE>":"<SOME_"+(n.type?n.type:"").toUpperCase()+"_VALUE>":n.default+"":i[n.name]+""})}return a},f=function(e,t,r){var i,a,s,n=[],o=e.paths[t][r];if(void 0!==o.consumes)for(var p in o.consumes){var f=o.consumes[p];n.push({name:"accept",value:f})}if(void 0!==o.produces)for(var c in o.produces){var m=o.produces[c];n.push({name:"content-type",value:m})}if(void 0!==o.parameters)for(var h in o.parameters){var v=o.parameters[h];if(void 0!==v.in&&"header"===v.in.toLowerCase()){if("string"==typeof v.$ref){if(/^http/.test(v.$ref))continue;v=u(e,v.$ref)}var l=e.openapi?v.schema.type:v.type;l||(l=""),n.push({name:v.name,value:"<SOME_"+l.toUpperCase()+"_VALUE>"})}}var y=e.securityDefinitions||e.components&&e.components.securitySchemes,d=o.security||e.security;if(y&&d)for(var b in d){var g=Object.keys(d[b])[0],O=y[g];if(O&&O.type)switch(O.type.toLowerCase()){case"basic":i=g;break;case"apikey":"query"===O.in&&(a=g);break;case"oauth2":s=g}}return i?n.push({name:"Authorization",value:"Basic <USERNAME:PASSWORD>"}):a?n.push({name:y[a].name,value:"REPLACE_KEY_VALUE"}):s&&n.push({name:"Authorization",value:"Bearer <BEARER_TOKEN>"}),n},u=function(e,t){var r=t.split("/");if(r.length<=1)return{};var i=function(e,t){if(t+1<r.length){var a=t+1;return i(e[r[t]],a)}return e[r[t]]};return i(e,1)};e.swagger2har=function(e,t){try{var r=t||function(e){var t="";return e.openapi&&e.servers?e.servers[0].url:(void 0!==e.schemes?t+=e.schemes[0]:t+="http","/"===e.basePath?t+="://"+e.host:e.basePath&&(t+="://"+e.host+e.basePath),t)}(e),i=[];return Object.keys(e.paths).forEach(t=>{Object.keys(e.paths[t]).forEach(a=>{var n=r+t,o=s(e,t,a,r);i.push({path:t,method:a.toUpperCase(),url:n,description:e.paths[t][a].description||"No description available",har:o})})}),i}catch(e){return console.error(e),null}},e.createHar=s,Object.defineProperty(e,"__esModule",{value:!0})});
